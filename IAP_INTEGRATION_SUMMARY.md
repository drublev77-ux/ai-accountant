# ‚úÖ –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –° –ú–ê–ì–ê–ó–ò–ù–ê–ú–ò –ü–†–ò–õ–û–ñ–ï–ù–ò–ô - –ó–ê–í–ï–†–®–ï–ù–ê

## üì± –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ü–ª–∞—Ç—Ñ–æ—Ä–º—ã

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ AI Accountant —É—Å–ø–µ—à–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –º–∞–≥–∞–∑–∏–Ω–∞–º–∏:

### 1. **Google Play Store** ‚úÖ
- **–°–µ—Ä–≤–∏—Å:** `src/services/google-play-iap.ts`
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è:** Google Play Billing Library
- **Product SKU:** `ai_accountant_lifetime_50usd`
- **–§—É–Ω–∫—Ü–∏–∏:**
  - ‚úì –ó–∞–ø—É—Å–∫ –ø–æ–∫—É–ø–∫–∏ —á–µ—Ä–µ–∑ Google Play
  - ‚úì –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ–∫–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
  - ‚úì –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ–∫—É–ø–∫–∏ (acknowledgement)
  - ‚úì –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –ø–æ–∫—É–ø–æ–∫

### 2. **Apple App Store** ‚úÖ
- **–°–µ—Ä–≤–∏—Å:** `src/services/apple-store-iap.ts`
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è:** StoreKit 2
- **Product ID:** `com.aiaccountant.lifetime.50usd`
- **–§—É–Ω–∫—Ü–∏–∏:**
  - ‚úì –ó–∞–ø—É—Å–∫ –ø–æ–∫—É–ø–∫–∏ —á–µ—Ä–µ–∑ App Store
  - ‚úì –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ–∫–æ–≤ —É Apple
  - ‚úì –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (finish)
  - ‚úì –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –ø–æ–∫—É–ø–æ–∫
  - ‚úì –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–∫–∏ (–¥–ª—è –±—É–¥—É—â–µ–≥–æ)

### 3. **Palm Store (webOS)** ‚úÖ
- **–°–µ—Ä–≤–∏—Å:** `src/services/palm-store-iap.ts`
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è:** webOS Payment Service
- **Product ID:** `aiaccountant_lifetime_access`
- **–§—É–Ω–∫—Ü–∏–∏:**
  - ‚úì –ó–∞–ø—É—Å–∫ –ø–æ–∫—É–ø–∫–∏ —á–µ—Ä–µ–∑ Palm Store
  - ‚úì –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ–∫–æ–≤
  - ‚úì –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∫—É–ø–∫–∞–º–∏
  - ‚úì –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–∫—É–ø–æ–∫

### 4. **–í–µ–±-–ø–ª–∞—Ç–µ–∂–∏** ‚úÖ
- Stripe (–∫—Ä–µ–¥–∏—Ç–Ω—ã–µ –∫–∞—Ä—Ç—ã)
- PayPal (—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π –∫–æ—à–µ–ª—ë–∫)
- Apple Pay
- Google Pay

## üéØ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ú–µ–Ω–µ–¥–∂–µ—Ä –ü–æ–∫—É–ø–æ–∫

### `purchase-manager.ts` - –ì–ª–∞–≤–Ω—ã–π –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä

**–§—É–Ω–∫—Ü–∏–∏:**
- üîç –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã (iOS, Android, webOS, Web)
- üõí –ï–¥–∏–Ω—ã–π API –¥–ª—è –ø–æ–∫—É–ø–æ–∫ –Ω–∞ –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö
- üîê –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ–∫–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- üîÑ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∫—É–ø–æ–∫
- üíæ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å localStorage

**API:**
```typescript
import { purchaseManager } from '@/services/purchase-manager';

// –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â—É—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É
const platform = purchaseManager.getPlatform();
// ‚Üí 'googleplay' | 'appstore' | 'palmstore' | 'web'

// –ö—É–ø–∏—Ç—å —á–µ—Ä–µ–∑ –º–∞–≥–∞–∑–∏–Ω
const result = await purchaseManager.purchaseViaStore();

// –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–∫—É–ø–∫–∏
const restored = await purchaseManager.restorePurchases();

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–∫—É–ø–∫–∏
const info = purchaseManager.getPurchaseInfo();
```

## üé® –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π UI

### PricingPaywall Component

**–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**

1. **–î–µ—Ç–µ–∫—Ç–æ—Ä –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç iOS, Android, webOS –∏–ª–∏ Web
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±–µ–π–¥–∂ —Å —Ç–µ–∫—É—â–µ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π
   - –ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –≤–∫–ª–∞–¥–∫—É –æ–ø–ª–∞—Ç—ã

2. **–ö–Ω–æ–ø–∫–∏ –º–∞–≥–∞–∑–∏–Ω–æ–≤**
   - üçé "Purchase on App Store" - –¥–ª—è iOS
   - ü§ñ "Purchase on Google Play" - –¥–ª—è Android
   - üì± "Purchase on Palm Store" - –¥–ª—è webOS

3. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∫—É–ø–æ–∫**
   - üîÑ –ö–Ω–æ–ø–∫–∞ "Restore Previous Purchase"
   - –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏
   - –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö

4. **–§–æ–ª–ª–±—ç–∫**
   - –ï—Å–ª–∏ IAP –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –≤–µ–±-–º–∞–≥–∞–∑–∏–Ω
   - –°–∏–º—É–ª—è—Ü–∏—è –ø–æ–∫—É–ø–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –°–±–æ—Ä–∫–∏

```
‚úÖ TypeScript –ø—Ä–æ–≤–µ—Ä–∫–∞: 0 –æ—à–∏–±–æ–∫
‚úÖ ESLint –ø—Ä–æ–≤–µ—Ä–∫–∞: 0 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
‚úÖ Build —Ä–∞–∑–º–µ—Ä: 683 KB (201 KB gzip)
‚úÖ Build –≤—Ä–µ–º—è: 3.82s
```

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –§–∞–π–ª–æ–≤

```
src/
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ google-play-iap.ts      # Google Play Billing
‚îÇ   ‚îú‚îÄ‚îÄ apple-store-iap.ts      # Apple StoreKit
‚îÇ   ‚îú‚îÄ‚îÄ palm-store-iap.ts       # Palm webOS Payment
‚îÇ   ‚îî‚îÄ‚îÄ purchase-manager.ts     # –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îî‚îÄ‚îÄ PricingPaywall.tsx      # –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π paywall —Å IAP
‚îî‚îÄ‚îÄ routes/
    ‚îî‚îÄ‚îÄ index.tsx               # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø–æ–∫—É–ø–∫–∏
```

## üîß –ö–∞–∫ —ç—Ç–æ –†–∞–±–æ—Ç–∞–µ—Ç

### –§–ª–æ—É –ü–æ–∫—É–ø–∫–∏

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
   ‚Üì
2. PurchaseManager –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—É
   ‚Üì
3. PricingPaywall –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–Ω–æ–ø–∫–∏
   ‚Üì
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã
   ‚Üì
5. –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–π IAP —Å–µ—Ä–≤–∏—Å
   ‚Üì
6. –ù–∞—Ç–∏–≤–Ω—ã–π –¥–∏–∞–ª–æ–≥ –ø–æ–∫—É–ø–∫–∏ (–∏–ª–∏ –≤–µ–±-—Ä–µ–¥–∏—Ä–µ–∫—Ç)
   ‚Üì
7. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≤–µ—Ä—à–∞–µ—Ç –ø–æ–∫—É–ø–∫—É
   ‚Üì
8. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —á–µ–∫/—Ç–æ–∫–µ–Ω
   ‚Üì
9. –°–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —á–µ–∫ —É –º–∞–≥–∞–∑–∏–Ω–∞
   ‚Üì
10. –ü–æ–∫—É–ø–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è
    ‚Üì
11. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è
    ‚Üì
12. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ localStorage
```

### –§–ª–æ—É –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "Restore Purchase"
   ‚Üì
2. PurchaseManager –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –ø–æ–∫—É–ø–æ–∫
   ‚Üì
3. –ú–∞–≥–∞–∑–∏–Ω –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –ø–æ–∫—É–ø–∫–∏
   ‚Üì
4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
   ‚Üì
5. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è
```

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ü—Ä–æ–¥–∞–∫—à–µ–Ω—É

### –ß—Ç–æ –†–∞–±–æ—Ç–∞–µ—Ç –°–µ–π—á–∞—Å (Development):

‚úÖ –î–µ—Ç–µ–∫—Ç–æ—Ä –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
‚úÖ –ú–æ–∫ IAP –¥–ª—è –≤—Å–µ—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤
‚úÖ –°–∏–º—É–ª—è—Ü–∏—è –ø–æ–∫—É–ø–æ–∫
‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage
‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∫—É–ø–æ–∫
‚úÖ –§–æ–ª–ª–±—ç–∫ –Ω–∞ –≤–µ–±-—Ä–µ–¥–∏—Ä–µ–∫—Ç

### –ß—Ç–æ –ù—É–∂–Ω–æ –¥–ª—è –ü—Ä–æ–¥–∞–∫—à–µ–Ω–∞:

#### Google Play:
1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Google Play Console
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Product SKU: `ai_accountant_lifetime_50usd`
3. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Google Play Billing Library (–≤ Android app)
4. –°–æ–∑–¥–∞—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç: `POST /api/verify-google-play-purchase`
5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏

#### Apple App Store:
1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ App Store Connect
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Product ID: `com.aiaccountant.lifetime.50usd`
3. –°–æ–∑–¥–∞—Ç—å StoreKit Configuration File
4. –°–æ–∑–¥–∞—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç: `POST /api/verify-apple-receipt`
5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Sandbox

#### Palm Store:
1. –°–æ–∑–¥–∞—Ç—å Palm Developer account
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Product ID: `aiaccountant_lifetime_access`
4. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å webOS SDK
5. –°–æ–∑–¥–∞—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç: `POST /api/verify-palm-purchase`

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Ñ–∞–π–ª–µ: **`STORE_INTEGRATION.md`**

–í–∫–ª—é—á–∞–µ—Ç:
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å–∏—Å—Ç–µ–º—ã
- API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- Backend —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞
- –ß–µ–∫–ª–∏—Å—Ç –¥–µ–ø–ª–æ—è
- Troubleshooting

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ AI Accountant —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ–∫—É–ø–∫–∏ —á–µ—Ä–µ–∑:**

- ‚úÖ Google Play Store (Android)
- ‚úÖ Apple App Store (iOS)
- ‚úÖ Palm Store (webOS)
- ‚úÖ –í–µ–±-–ø–ª–∞—Ç–µ–∂–∏ (Stripe, PayPal, Apple Pay, Google Pay)

**–í—Å–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**
- ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ –ì–æ—Ç–æ–≤—ã –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É
- ‚úÖ –° –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–∫—É–ø–æ–∫

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ–∫–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)
- ‚úÖ HTTPS –¥–ª—è –≤—Å–µ—Ö API –≤—ã–∑–æ–≤–æ–≤
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —á–µ–∫–æ–≤
- ‚úÖ Rate limiting –¥–ª—è —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- ‚úÖ –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ sensitive –¥–∞–Ω–Ω—ã—Ö

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í–û –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ –ò –î–ï–ü–õ–û–Æ!
